<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:cats="http://www.ithaka.org/cats"
	template="../layout/list_template.xhtml">	
	
	<ui:param name="entityType" value="collections" />
	<ui:define name="body">
	
		<ui:include src="../layout/tablenav.xhtml">
			<ui:param name="viewPath" value="/lists/CatCollectionsList.xhtml"></ui:param>
			<ui:param name="entityList" value="#{catCollectionsList}"></ui:param>
			<ui:param name="divId" value="1" />
		</ui:include>
		<a:form>
			<s:div id="header" styleclass="header">
				<div class="left">
				<span class="museo"><h:outputText
					value="Collections (#{empty catCollectionsList.resultList ? 0 : (catCollectionsList.paginated ? catCollectionsList.resultCount : catCollectionsList.resultList.size)})"></h:outputText>
				</span> 
				<h:selectOneMenu name="flavour" value="#{catCollectionsList.flavour}">
					<s:selectItems value="#{catCollectionsList.flavours}" var="i"
						itemValue="#{i}" label="#{catCollectionsList.flavourLabel(i)}" />						
					<a:support event="onchange" action="#{catCollectionsList.updateUserSkinPreferences}"
								oncomplete="javascript: location.href='CatCollectionsList.seam'"
								ignoreDupResponses="true"
								eventsQueue="collsListQueue"
								ajaxSingle="true"/>
				</h:selectOneMenu>			
				<s:link id="clearSearch" status="globalWaitStatus" 
					ignoreDupResponses="true" styleClass="button wizard" 
					action="#{catCollectionsList.reset}"  value="X" 
					ajaxSingle="true" propagation="none"
					oncomplete="javascript: location.href='CatCollectionsList.seam'">
					<f:param name="flavour" value="#{catCollectionsList.flavour}"/> 
				</s:link>
				</div>

				<div class="right"><h:selectOneMenu
					id="catCollectionsListBulkOperationsSelect"
					rendered="#{not empty catCollectionsBulkOperations.bulkOperationsNames}"
					value="#{catCollectionsBulkOperations.bulkOperationsType}">
					<a:support event="onchange"
						action="#{catCollectionsBulkOperations.prepBulkOperations( 'catCollectionsList', 'catCollectionsListBulkOperationsSelect' )}"
						reRender="collectionsBulkOperationsPanels,catCollectionsList"
						oncomplete="if ( #{rich:element('catCollectionsListBulkOperationsSelect')}.options.selectedIndex != 0 ) { #{rich:component('catCollectionsListBulkUpdatePanel')}.show(); } ; return false; " />
					<s:selectItems
						value="#{catCollectionsBulkOperations.bulkOperationsNames}"
						var="b" label="#{catCollectionsBulkOperations.bulkOperations[b]}"
						itemValue="#{b}" noSelectionLabel="Bulk Operations" />
				</h:selectOneMenu>
				<a:commandLink 
					ignoreDupResponses="true"
			   		value="Add Collection"
			   		action="#{createCollectionWizard.prepareCreate()}"
					reRender="createCollectionForm" 
					oncomplete="#{rich:component('createCollectionWizardModal')}.show(); return false;"
					styleClass="button wizard #{!s:hasPermission(catCollectionsHome.instance, 'create Collections') ? 'disabled' : ''}"
					disabled="#{!s:hasPermission(catCollectionsHome.instance, 'create Collections')}"
					status="globalWaitStatus"
					ajaxSingle="true"/>
				<ui:include src="adhocReportSelect.xhtml">
					<ui:param name="entityQuery" value="#{catCollectionsList}" />
				</ui:include> 

				<s:link styleClass="button wizard"
					rendered="#{s:hasPermission(catCollectionsList.catCollections, 'create CatCollections')}"
					view="/home.xhtml" propagation="none" value="Create Collection" />
				</div>
			</s:div>
			<!-- Shows hour glass when the table is loading -->
			<div id="globalStatusDiv" style="display: none;"><img
				src="../img/loading.gif" /></div>
			<a:status id="globalWaitStatus" forceId="true" layout="none"
				onstart="jQuery('#globalStatusDiv').fadeIn('fast')"
				onstop="jQuery('#globalStatusDiv').fadeOut('slow')" />

			<div class="push" />

			<div id="mainlistscroller"> <h:dataTable
				id="catCollectionsList" var="_catCollections"
				value="#{catCollectionsList.resultList}"				
				rowClasses="odd,even"
				styleClass="mainListClass">

				<rich:column styleClass="checkBoxes" headerClass="checkBoxes"
					rendered="#{not empty catCollectionsBulkOperations.bulkOperationsNames}">
					<f:facet name="header">
						<h:panelGrid columns="1">
							<h:outputText value=" " />
							<input type="checkbox" id="select_all_checkbox"
								name="select_all_checkbox"
								onclick="toggleCheckboxes(this.checked, 'bulk_checkbox');" />
						</h:panelGrid>
					</f:facet>
					<div onclick="cancelEventBubbling(event);"><h:selectBooleanCheckbox
						styleClass="bulk_checkbox checkBoxes"
						value="#{catCollectionsBulkOperations.selections[_catCollections]}" /></div>
				</rich:column>

				<cats:column styleClass="id" rendered="#{catCollectionsList.listFlavour['id']}" linkToId="#{_catCollections.id}"
					entityList="#{catCollectionsList}" propertyLabel="ID"
					propertyPath="catCollections.id"
					propertyValue="#{catCollectionsList.catCollections.id}"
					propertyName="id" sortable="true" value="#{_catCollections.id}"></cats:column>
				<cats:column styleClass="catAnncmntDateActl" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catAnncmntDateActl']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Actual Announcement"
					propertyPath="catCollections.catAnncmntDateActl"
					propertyValue="#{catCollectionsList.catCollections.catAnncmntDateActl}"
					propertyName="catAnncmntDateActl" sortable="true"
					value="#{_catCollections.catAnncmntDateActl}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catAnncmntDatePrjd" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catAnncmntDatePrjd']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Projected Announcement"
					propertyPath="catCollections.catAnncmntDatePrjd"
					propertyValue="#{catCollectionsList.catCollections.catAnncmntDatePrjd}"
					propertyName="catAnncmntDatePrjd" sortable="true"
					value="#{_catCollections.catAnncmntDatePrjd}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catAnncmntDateSchd" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catAnncmntDateSchd']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Scheduled Announcement"
					propertyPath="catCollections.catAnncmntDateSchd"
					propertyValue="#{catCollectionsList.catCollections.catAnncmntDateSchd}"
					propertyName="catAnncmntDateSchd" sortable="true"
					value="#{_catCollections.catAnncmntDateSchd}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catCreator" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catCreator']}"
					entityList="#{catCollectionsList}" propertyLabel="Creator"
					propertyPath="catCollections.catCreator"
					propertyValue="#{catCollectionsList.catCollections.catCreator}"
					propertyName="catCreator" sortable="true"
					value="#{_catCollections.catCreator}"></cats:column>
				<cats:column styleClass="catDateCreated" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catDateCreated']}"
					entityList="#{catCollectionsList}" propertyLabel="Date Created"
					propertyPath="catCollections.catDateCreated"
					propertyValue="#{catCollectionsList.catCollections.catDateCreated}"
					propertyName="catDateCreated" sortable="true"
					value="#{_catCollections.catDateCreated}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catLaunchDateActl" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catLaunchDateActl']}"
					entityList="#{catCollectionsList}" propertyLabel="Launch Date"
					propertyPath="catCollections.catLaunchDateActl"
					propertyValue="#{catCollectionsList.catCollections.catLaunchDateActl}"
					propertyName="catLaunchDateActl" sortable="true"
					value="#{_catCollections.catLaunchDateActl}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catLaunchDatePrjd" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catLaunchDatePrjd']}"
					entityList="#{catCollectionsList}" propertyLabel="Projected Launch"
					propertyPath="catCollections.catLaunchDatePrjd"
					propertyValue="#{catCollectionsList.catCollections.catLaunchDatePrjd}"
					propertyName="catLaunchDatePrjd" sortable="true"
					value="#{_catCollections.catLaunchDatePrjd}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catLaunchDateSchd" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catLaunchDateSchd']}"
					entityList="#{catCollectionsList}" propertyLabel="Scheduled Launch"
					propertyPath="catCollections.catLaunchDateSchd"
					propertyValue="#{catCollectionsList.catCollections.catLaunchDateSchd}"
					propertyName="catLaunchDateSchd" sortable="true"
					value="#{_catCollections.catLaunchDateSchd}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catLifecycle" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catLifecycle']}"
					entityList="#{catCollectionsList}" propertyLabel="Lifecycle"
					propertyPath="catCollections.catLifecycle"
					propertyValue="#{catCollectionsList.catCollections.catLifecycle}"
					propertyName="catLifecycle" sortable="true"
					enumList="#{listsForEnums.catCollections_Lifecycle}"
					value="#{_catCollections.catLifecycle.label}"></cats:column>
				<cats:column styleClass="catMinPromCmpltnDateActl" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catMinPromCmpltnDateActl']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Actual Promise Completion Date"
					propertyPath="catCollections.catMinPromCmpltnDateActl"
					propertyValue="#{catCollectionsList.catCollections.catMinPromCmpltnDateActl}"
					propertyName="catMinPromCmpltnDateActl" sortable="true"
					value="#{_catCollections.catMinPromCmpltnDateActl}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catMinPromCmpltnDatePrjd" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catMinPromCmpltnDatePrjd']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Projected Promise Completion Date"
					propertyPath="catCollections.catMinPromCmpltnDatePrjd"
					propertyValue="#{catCollectionsList.catCollections.catMinPromCmpltnDatePrjd}"
					propertyName="catMinPromCmpltnDatePrjd" sortable="true"
					value="#{_catCollections.catMinPromCmpltnDatePrjd}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catMinPromCmpltnDateSchd" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catMinPromCmpltnDateSchd']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Scheduled Promise Completion"
					propertyPath="catCollections.catMinPromCmpltnDateSchd"
					propertyValue="#{catCollectionsList.catCollections.catMinPromCmpltnDateSchd}"
					propertyName="catMinPromCmpltnDateSchd" sortable="true"
					value="#{_catCollections.catMinPromCmpltnDateSchd}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catMinPromSetCnt" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catMinPromSetCnt']}"
					entityList="#{catCollectionsList}" propertyLabel="Promised Sets"
					propertyPath="catCollections.catMinPromSetCnt"
					propertyValue="#{catCollectionsList.catCollections.catMinPromSetCnt}"
					propertyName="catMinPromSetCnt" sortable="true"
					value="#{_catCollections.catMinPromSetCnt}"></cats:column>
				<cats:column styleClass="catMinPromSigningDeadline" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catMinPromSigningDeadline']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Minimum Promise Signing Deadline"
					propertyPath="catCollections.catMinPromSigningDeadline"
					propertyValue="#{catCollectionsList.catCollections.catMinPromSigningDeadline}"
					propertyName="catMinPromSigningDeadline" sortable="true"
					value="#{_catCollections.catMinPromSigningDeadline}">
					<s:convertDateTime type="date" pattern="yyyy/MM/dd"></s:convertDateTime>
				</cats:column>
				<cats:column styleClass="catName" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catName']}"
					entityList="#{catCollectionsList}" propertyLabel="Name"
					propertyPath="catCollections.catName"
					propertyValue="#{catCollectionsList.catCollections.catName}"
					propertyName="catName" sortable="true"
					value="#{_catCollections.catName}"></cats:column>
				<cats:column styleClass="catOtherPromContentNote" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catOtherPromContentNote']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Other promised content"
					propertyPath="catCollections.catOtherPromContentNote"
					propertyValue="#{catCollectionsList.catCollections.catOtherPromContentNote}"
					propertyName="catOtherPromContentNote" sortable="true"
					value="#{_catCollections.catOtherPromContentNote}"></cats:column>
				<cats:column styleClass="catPageBudget" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catPageBudget']}"
					entityList="#{catCollectionsList}" propertyLabel="Page Budget"
					propertyPath="catCollections.catPageBudget"
					propertyValue="#{catCollectionsList.catCollections.catPageBudget}"
					propertyName="catPageBudget" sortable="true"
					value="#{_catCollections.catPageBudget}"></cats:column>
				<cats:column styleClass="catTargetSetCnt" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catTargetSetCnt']}"
					entityList="#{catCollectionsList}" propertyLabel="Target Set Count"
					propertyPath="catCollections.catTargetSetCnt"
					propertyValue="#{catCollectionsList.catCollections.catTargetSetCnt}"
					propertyName="catTargetSetCnt" sortable="true"
					value="#{_catCollections.catTargetSetCnt}"></cats:column>
				<cats:column styleClass="catType" linkToId="#{_catCollections.id}"
					rendered="#{catCollectionsList.listFlavour['catType']}"
					entityList="#{catCollectionsList}" propertyLabel="Type"
					propertyPath="catCollections.catType"
					propertyValue="#{catCollectionsList.catCollections.catType}"
					propertyName="catType" sortable="true"
					enumList="#{listsForEnums.catCollections_Type}"
					value="#{_catCollections.catType.label}"></cats:column>

				<cats:column linkToId="#{_catCollections.id}" sortable="true"
					rendered="#{catCollectionsList.listFlavour['catDateModified']}"
					entityList="#{catCollectionsList}"
					propertyLabel="Date Modified"
					propertyPath="catCollections.catDateModified"
					propertyValue="#{catCollectionsList.catCollections.catDateModified}"
					propertyName="catDateModified"
					value="#{_catCollections.catDateModified}">
					<s:convertDateTime type="both" pattern="yyyy/MM/dd HH:mm:ss"></s:convertDateTime>
				</cats:column>



			</h:dataTable></div>
		</a:form>
		<ui:include src="../layout/tablenav.xhtml">
			<ui:param name="viewPath" value="/lists/CatCollectionsList.xhtml"></ui:param>
			<ui:param name="entityList" value="#{catCollectionsList}"></ui:param>
			<ui:param name="divId" value="2" />
		</ui:include>


		<ui:include src="/collections/bulkm_Collections.xhtml" >
			<ui:param name="divParam" value="collectionsList"/>
		</ui:include>		
		<ui:include src="/collections/createm_Collection.xhtml" />
		<!-- when used in conjunction with a BaseListFlavour, this will order the columns per the configuration order. -->
		<rich:jQuery timing="onload" name="orderColumns"
			selector="#mainlistscroller > .mainListClass > thead:first-child > tr:first-child, #mainlistscroller > .mainListClass > tbody > tr"
			query="#{catCollectionsList.listFlavour.getColumnOrderingJQuery()}" id="orderJQuery"/>
	</ui:define>
</ui:composition>
