<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:z="http://www.qualcomm.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:cats="http://www.ithaka.org/cats"
	xmlns:s="http://jboss.com/products/seam/taglib">

	<h2><h:outputText value="#{contractDetailsLifecycleWizard.bulkTitle}"/></h2>

	<div id="step1">
	<ul class="steps">
			<li class="disabled">1. Advance</li>
			<li class="selected">2. Info</li>
			<li class="disabled">3. Roles-Riders</li>
			<li class="disabled">4. Results</li>
	</ul>
	
	<div class="cluster">	
		<div class="title change">
			<h1> Agreement Details </h1>
			<p>Some fields must be filled out on the Agreement Details in order to set the lifecycle to <strong>#{contractDetailsLifecycleWizard.bulkInstance.catLifecycle.label}</strong>. 
				The system will use the following values for your Agreement Details:</p>
		</div>		
		<div class="push"></div>
		<s:decorate id="catOutcome_div" template="../layout/edit.xhtml" rendered="#{contractDetailsLifecycleWizard.bulkInstance.catLifecycle eq 'Terminated'}">
			<ui:define name="label">Outcome</ui:define>
			<h:selectOneMenu value="#{contractDetailsLifecycleWizard.catOutcomeValue}" required="true" rendered="#{contractDetailsLifecycleWizard.parentContract.catType eq 'Backfile'}">
				<s:selectItems itemValue="#{i}" label="#{i.label}" value="#{contractDetailsLifecycleWizard.catContractDtls_Outcome_backfileList}" var="i" noSelectionLabel="Choose..."/>
				<a:support event="onchange" action="#{contractDetailsLifecycleWizard.resetLists}" reRender="outcomeWithdrawnPanel,newContractsPanel, pubRolesPanel" ajaxSingle="true" status="globalWaitStatus" limitToList="true"/> 								
			</h:selectOneMenu>
			<h:selectOneMenu value="#{contractDetailsLifecycleWizard.catOutcomeValue}" required="true" rendered="#{contractDetailsLifecycleWizard.parentContract.catType eq 'Csp'}">
				<s:selectItems itemValue="#{i}" label="#{i.label}" value="#{listsForEnums.catContractDtls_Outcome}" var="i" noSelectionLabel="Choose..."/>
				<a:support event="onchange" action="#{contractDetailsLifecycleWizard.resetLists}" reRender="outcomeWithdrawnPanel,newContractsPanel, pubRolesPanel" ajaxSingle="true" status="globalWaitStatus" limitToList="true"/> 								
			</h:selectOneMenu>
			<span class="comments">Why are these Agreement Details being terminated? Use <strong>Transferred</strong> if the content will now be covered by a different licensor's Agreement. Use <strong>Signed New Agreement</strong> if the licensor signed a newer version of the Agreement for this content. Use <strong>Publisher Terminated</strong> if the CSP Publisher is no longer publishing the journal.</span>
		</s:decorate>
		<a:outputPanel id="outcomeWithdrawnPanel">
			<s:div styleClass="alert" rendered="#{contractDetailsLifecycleWizard.catOutcomeValue eq 'Withdrawn'}">
				<p>You indicated that the content covered by these Agreement Details is being withdrawn from JSTOR. The system will attempt to set the <strong>Withdrawn Status</strong> on every affected component as follows: If the Agreement Detail covered all of the component, the system will set the <strong>Withdrawn Status</strong> to <strong>All</strong>; If the Agreement Detail covered part of the component, the system will set the <strong>Withdrawn Status</strong> to <strong>Part</strong>. If you know the component was covered by more than one Agreement Detail and all parts have now been withdrawn, please change the component's <strong>Withdrawn Status</strong> to <strong>All</strong> after you complete this wizard.</p>
			</s:div>
		</a:outputPanel>
		
		<div class="smart edittable">
			<a:outputPanel layout="block" id="backFileContractDtlsPanel">			
					<s:div rendered="#{contractDetailsLifecycleWizard.parentContract.catType eq 'Backfile'}">
						<ui:include src="advContractDetailsLifecycle_backfileInfo.xhtml"/>
					</s:div>
			</a:outputPanel>
			
			<a:outputPanel layout="block" id="cspContractDtlsPanel">			
					<s:div rendered="#{contractDetailsLifecycleWizard.parentContract.catType eq 'Csp'}">
						<ui:include src="advContractDetailsLifecycle_cspInfo.xhtml"/>
					</s:div>
			</a:outputPanel>		
				
			<a:outputPanel layout="block" id="newContractsPanel">			
				<s:div rendered="#{contractDetailsLifecycleWizard.catOutcomeValue eq 'Transferred' or 
									contractDetailsLifecycleWizard.catOutcomeValue eq 'Signednewcontract'}">
					<ui:include src="advContractDetailsLifecycle_contractsTable.xhtml"/>
				</s:div>
			</a:outputPanel>
		</div>			
    </div>
     <div class="push"></div>                     
	<a:commandLink styleClass="button" value="Quit" limitToList="true"
		oncomplete="#{rich:component('contLifecycleUpdateQuit')}.show();"  status="globalWaitStatus" ignoreDupResponses="true"/>
	        
	<a:outputPanel id="continuePanel">
		<a:commandLink styleClass="button right" value="Continue" status="globalWaitStatus" ignoreDupResponses="true"
			disabled="#{not empty contractDetailsLifecycleWizard.errorMsgs}"
			action="#{contractDetailsLifecycleWizard.bulkNext}" reRender="contLfclWizard" limitToList="true"/>
	</a:outputPanel>			
	
	
	</div>
</ui:composition>
