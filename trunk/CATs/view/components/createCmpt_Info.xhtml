<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:z="http://www.qualcomm.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:cats="http://www.ithaka.org/cats"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:dui="http://openorganize.com/platform/dui">

	<h2><h:outputText value="#{createComponentWizard.wizardTitle}" /></h2>

	<div id="step1">
		<ul class="steps">
			<li class="selected">1. Info</li>
			<li class="disabled">2. Results</li>
		</ul>
		<div class="cluster smart">
		<a:outputPanel layout="none" id="noLayoutFatalMsgs">
				<s:div styleClass="alert">
					<s:div rendered="#{not empty catCmptsHome.fatalMsgs}" id="fatalMsgsDiv">
						<a:repeat value="#{catCmptsHome.fatalMsgs}" var="_fatalMsg">
							<p>#{_fatalMsg}</p>
						</a:repeat>
					</s:div>
				</s:div>
		</a:outputPanel>
		<a:outputPanel layout="none" id="noLayoutWarningMsgs">
				<s:div styleClass="alert">
					<s:div rendered="#{not empty catCmptsHome.warningMsgs}" id="warningMsgsDiv">
						<a:repeat value="#{catCmptsHome.warningMsgs}" var="_warningMsg">
							<p>#{_warningMsg}</p>
						</a:repeat>
					</s:div>
				</s:div>
		</a:outputPanel>
			<div class="title change">
				<h1>Info</h1>
				<p>Enter information about the new component.</p>
			</div>
			<s:div rendered="#{createComponentWizard.showSelectSetMsg}" styleClass="alert">
					<p>You must choose a set.</p>
			</s:div>
			<a:outputPanel layout="none" id="parentSetLayout">
				<s:decorate template="../layout/edit.xhtml" rendered="#{!createComponentWizard.chooseAnotherSet}">
					<ui:define name="label">Set Name</ui:define>
					<s:fragment rendered="#{not empty createComponentWizard.parentSet}"> 
						<span class="read_only"><strong>#{createComponentWizard.parentSet.catCurrentTitle.catName}</strong></span>
					</s:fragment>
					<s:fragment rendered="#{empty createComponentWizard.parentSet}"> 
						<span class="read_only"><strong> </strong></span>
					</s:fragment>
					<span class="comments">
	               		<a:commandLink styleClass="button find" value="Choose Another"
							action="#{createComponentWizard.showSetList}"
							reRender="createCmptForm" 
							eventsQueue="journalQueue"
							status="globalWaitStatus"/>
	               	</span>
	            </s:decorate>
	         </a:outputPanel>
            
            <a:outputPanel layout="none" id="noLayoutSetList">
			<s:div id="chooseSetsFragment" rendered="#{createComponentWizard.chooseAnotherSet}">
				<h:inputText id="default_search_catSetsList" 
		 			value="#{catSetsList.catSets.catCurrentTitle.catName}" 
		 			onchange="return false;" size="60">
		 			
		 		</h:inputText>

			  	<a:commandLink 
			  		 styleClass="button filter"
					 value="Filter"
					 action="#{createComponentWizard.narrowSetsList(rich:findComponent('default_search_catSetsList').value)}"
					 reRender="createCmptForm"
					 status="globalWaitStatus" />
	
				<s:div id="otherSetFilterTable" styleClass="scroller">
				<rich:panel>
					<f:facet name="header">
						<h:outputText value="Sets (#{catSetsList.resultCount})" />
					</f:facet>
				</rich:panel>
				  <rich:dataTable id="sets"
					value="#{catSetsList.resultList}" var="_setsRollup">
					<rich:column styleClass="checkBoxes" headerClass="checkBoxes">
						<h:selectBooleanCheckbox styleClass="entity_checkbox"
							value="#{createComponentWizard.selectionsForSets[_setsRollup]}"
							onclick="emulateRadios(this, 'entity_checkbox');">
							<a:support event="onchange" 
							action="#{createComponentWizard.selectOtherParent}"
							reRender="createCmptForm, otherCmptsListLayout" 
							eventsQueue="journalQueue"
							status="globalWaitStatus"/>
						</h:selectBooleanCheckbox>
					</rich:column>
	
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="Name"
						propertyName="catName"
						propertyPath="catSets.catCurrentTitle.catName"
						propertyValue="#{catSetsList.catSets.catCurrentTitle.catName}"
						reRender="sets"
						value="#{_setsRollup.catCurrentTitle.catName}"/>
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="Print ISSN"
						propertyName="printISSN"
						propertyPath="catSets.catCurrentTitle.catPrintIssn"
						propertyValue="#{catSetsList.catSets.catCurrentTitle.catPrintIssn}"
						reRender="sets"
						value="#{_setsRollup.catCurrentTitle.catPrintIssn}"/>
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="Start Year"
						propertyName="startYear"
						propertyPath="catSets.catCurrentTitle.catStartYear"
						propertyValue="#{catSetsList.catSets.catCurrentTitle.catStartYear}"
						reRender="sets"
						value="#{_setsRollup.catCurrentTitle.catStartYear}">
						<s:convertDateTime type="date" pattern="yyyy"/>
					</cats:wizardColumn>	
						
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="Extent (Pub Units)"
						propertyName="catThpubUnits"
						propertyPath="catSets.catThPublctnUnitRange"
						propertyValue="#{catSetsList.catSets.catThPublctnUnitRange}"
						reRender="sets"
						value="#{_setsRollup.catThPublctnUnitRange}"/>
						
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="Extent (Dates)"
						propertyName="catThDateRange"
						propertyPath="catSets.catThDateRange"
						propertyValue="#{catSetsList.catSets.catThDateRange}"
						reRender="sets"
						value="#{_setsRollup.catThDateRange}"/>
					
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="Lifecycle"
						propertyName="catLifecycle"
						propertyPath="catSets.catLifecycle"
						propertyValue="#{catSetsList.catLifecycle}"
						reRender="sets"
						value="#{_setsRollup.catLifecycle.label}"/>
					
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="Selection Status"
						propertyName="selStatus"
						propertyPath="catSets.selectionRightsValue"
						propertyValue="#{catSetsList.catSets.selectionRightsValue}"
						reRender="sets"
						value="#{_setsRollup.selectionRightsValue}"/>
					
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="BF Prod Status"
						propertyName="prodStatus"
						propertyPath="catSets.productionStatusValue"
						propertyValue="#{catSetsList.catSets.productionStatusValue}"
						reRender="sets"
						value="#{_setsRollup.productionStatusValue}"/>
					
					<cats:wizardColumn
						entityList="#{catSetsList}"
						propertyLabel="Title History Status"
						propertyName="catTHStatus"
						propertyPath="catSets.catThStatus"
						propertyValue="#{catSetsList.catThStatus}"
						reRender="sets"
						value="#{_setsRollup.catThStatus.label}"/>
				</rich:dataTable>
			</s:div>
		</s:div>	
				
		</a:outputPanel>
            
            
			<s:decorate template="../layout/edit.xhtml">
				<ui:define name="label">Component Initial Article</ui:define>
				<h:inputText
					id="catIniArtWiz" maxlength="20" size="25"
					value="#{createComponentWizard.catCmptsHome.instance.catIniArt}" />
				<span class="comments">Examples: the, a, la,el </span>
			</s:decorate>
			<s:decorate template="../layout/edit.xhtml">
				<ui:define name="label">Component Name</ui:define>
				<h:inputTextarea id="journalName" rows="2" cols="20"  
               		value="#{createComponentWizard.catCmptsHome.instance.catName}" required="true" requiredMessage="You must fill out component name"/>
               	<span class="comments">
               		<a:commandLink styleClass="button find" value="Check for Duplicates"
						action="#{createComponentWizard.checkForDuplicates}"
						reRender="createCmptForm" 
						eventsQueue="journalQueue"
						status="globalWaitStatus"/>
               	</span>
            </s:decorate>
			
			
			<a:outputPanel layout="none" id="noLayoutNoDups">
				<s:div rendered="#{createComponentWizard.checkForDup and !createComponentWizard.hasDups}" styleClass="alert eligible">
					<p>No other sets or components share this name.</p>
				</s:div>
			</a:outputPanel>
			
			<a:outputPanel layout="none" id="noLayoutHasDups">
				<s:div rendered="#{createComponentWizard.checkForDup and createComponentWizard.hasDups}" styleClass="alert">
					<p><strong>#{createComponentWizard.duplicateCmpts.size}</strong> components share this name. Click <strong>Continue</strong> if you want to make the duplicate.</p>
				</s:div>
				<s:fragment rendered="#{not empty createComponentWizard.duplicateCmpts}">
				
					<div class="scroller">
			   			 <rich:dataTable id="catCmptsListCmpWiz"
			                var="_catCmpts"
			              	value="#{createComponentWizard.duplicateCmpts}"
			              	rowClasses="odd,even">
			           
			        	<rich:column id="col1">
			        	<f:facet name="header">
			        		<h:outputText value="Lifecycle" id="lifeCycle" />
			        	</f:facet>
						<h:outputText value="#{_catCmpts.catLifecycle}" />        		
			        	</rich:column>
			        	
			        	<rich:column id="col11">
			        	<f:facet name="header">
			        		<h:outputText value="BF Prod Status" id="prodStatus" />
			        	</f:facet>
						<h:outputText value="#{_catCmpts.catProductionStatus.label}" />        		
			        	</rich:column>
			        	
			        	<rich:column id="col2">
			        	<f:facet name="header">
			        		<h:outputText value="Set Name" id="setname" />
			        	</f:facet>
						<h:outputText value="#{_catCmpts.setsValue}" />        		
			        	</rich:column>
			        	
			        	<rich:column id="col3">
			        	<f:facet name="header">
			        		<h:outputText value="Component Name" id="cmptname" />
			        	</f:facet>
						<h:outputText value="#{_catCmpts.catName}" />        		
			        	</rich:column>
			        	
			        	<rich:column id="col7">
			        	<f:facet name="header">
			        		<h:outputText value="Extent (Pub Units)" id="cmptpurange" />
			        	</f:facet>
						<h:outputText value="#{_catCmpts.catPublctnUnitRange}" />        		
			        	</rich:column>
			        	
			        	<rich:column id="col8">
			        	<f:facet name="header">
			        		<h:outputText value="Extent (Dates)" id="cmptdateRange" />
			        	</f:facet>
						<h:outputText value="#{_catCmpts.catDateRange}" />        		
			        	</rich:column>
			        	
			        	<rich:column id="col6">
			        	<f:facet name="header">
			        		<h:outputText value="Print ISSN" id="cmptissn" />
			        	</f:facet>
						<h:outputText value="#{_catCmpts.catPrintIssn}" />        		
			        	</rich:column>
			        	
			        	<rich:column id="col12">
			        	<f:facet name="header">
			        		<h:outputText value="Publisher Roles" id="PublisherValue" />
			        	</f:facet>
						<h:outputText value="#{_catCmpts.publisherValue}" />        		
			        	</rich:column>
			        	
			       	
			        	</rich:dataTable>
		        	</div>
	        	
				</s:fragment>
			</a:outputPanel>
			
			<s:decorate template="../layout/edit.xhtml">
				<ui:define name="label">Component Subtitle</ui:define>
				<h:inputTextarea cols="20"
					id="catSubtitleWiz" rows="2"
					value="#{createComponentWizard.catCmptsHome.instance.catSubtitle}" />
			</s:decorate> 	
			
			<s:decorate template="../layout/editDate.xhtml">
				<ui:define name="label">Start Year</ui:define>
				
				
			<h:inputText value="#{createComponentWizard.catCmptsHome.instance.catStartYear}" id="catStartYear6"  ><s:convertDateTime type="date" pattern="yyyy"/></h:inputText>
				
				<span class="comments">4 digit year. <em>Example: 1901</em></span>
			</s:decorate>
			
			<s:decorate template="../layout/edit.xhtml">
				<ui:define name="label">Print ISSN</ui:define>
				<h:inputText
					id="catPrintIssn1" maxlength="50" size="25"
					value="#{createComponentWizard.catCmptsHome.instance.catPrintIssn}">
					<a:support event="onblur" action="#{catCmptsHome.printIssnChanged()}" eventsQueue="journalQueue"/>
					<a:support event="onfocus" action="#{catCmptsHome.onFocusPrintIssn}" eventsQueue="journalQueue"/>
				</h:inputText>
				<span class="comments">Include dashes and capitalize X. Leave blank if unknown. <em>Example: 1345-274X</em></span>
			</s:decorate>
			
			<s:decorate template="../layout/edit.xhtml">
				<ui:define name="label">Current Title</ui:define>
				<h:selectOneMenu id="crntTitleCmptWiz" value="#{createComponentWizard.isCurrentTitle}">
					<f:selectItem itemValue="true" itemLabel="Yes"/>
					<f:selectItem itemValue="false" itemLabel="No"/>
				</h:selectOneMenu>
					
				<span class="comments">Is this the set's current title?</span>
			</s:decorate>
			
			<a:outputPanel layout="none" id="otherCmptsListLayout">
				<s:fragment id="otherCmptsList" rendered="#{not empty createComponentWizard.parentSet}">
					<div class="title child">
						<h1>Other Components in this Set (#{createComponentWizard.parentSet.catSetsComponentsList.size})</h1>
		            	<p>The following components are already in this set:</p>
					</div>
					<div class="scroller">
				   		<rich:dataTable id="catOtherCmptsList"
				            var="_catCmpts"
				           	value="#{createComponentWizard.parentSet.catSetsComponentsList}">
				           	
				           	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="Sets" id="setname" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.setsValue}" />        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="Component Name" id="cmptname" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catName}" />        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="Print ISSN" id="cmptissn" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catPrintIssn}" />        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="ISSN Request Status" id="cmptissnstatus" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catIssnStatus.label}" />        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="Start Year" id="cmptStYear" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catStartYear}">
									<s:convertDateTime type="date" pattern="yyyy"/>
								</h:outputText>        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="Extent (Pub Units)" id="cmptpurange" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catPublctnUnitRange}" />        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="Extent (Dates)" id="cmptdateRange" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catDateRange}" />        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="Lifecycle" id="lifeCycle" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catLifecycle.label}" />        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="Selection Status" id="selStatus" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catSelectionStatus.label}" />        		
				        	</rich:column>
				        	
				        	<rich:column>
					        	<f:facet name="header">
					        		<h:outputText value="BF Prod Status" id="prodStatus" />
					        	</f:facet>
								<h:outputText value="#{_catCmpts.catProductionStatus.label}" />        		
				        	</rich:column>
				        	
				        </rich:dataTable>
			        </div>
				</s:fragment>
			</a:outputPanel>
			
		</div>
		
		
		
		<div class="push"></div>
	
		<a:commandLink styleClass="button" value="Quit"
			oncomplete="#{rich:component('createCmptQuit')}.show(); return false;"
			ajaxSingle="true"
			eventsQueue="journalQueue"
			status="globalWaitStatus"
			reRender="createCmptQuit"/>
		 
		
		<a:commandLink styleClass="button right" value="Save"
			rendered="#{not empty createComponentWizard.parentSet}"
			action="#{createComponentWizard.saveComponent}"
			reRender="createCmptForm"
			eventsQueue="journalQueue"
			status="globalWaitStatus"/>
		
		<a:commandLink styleClass="button right" value="Save"
			rendered="#{empty createComponentWizard.parentSet and createComponentWizard.chooseAnotherSet}"
			action="#{createComponentWizard.saveComponent}"
			reRender="createCmptForm"
			eventsQueue="journalQueue"
			status="globalWaitStatus"
			onclick="if(checkRadios('entity_checkbox', 'Please select a Set') == false) {return false};"/>
		
		<a:commandLink styleClass="button right" value="Save"
			rendered="#{empty createComponentWizard.parentSet and !createComponentWizard.chooseAnotherSet}"
			action="#{createComponentWizard.saveComponent}"
			reRender="createCmptForm"
			eventsQueue="journalQueue"
			status="globalWaitStatus"/>
		
	</div>
</ui:composition>
