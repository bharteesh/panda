<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:z="http://www.qualcomm.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:cats="http://www.ithaka.org/cats"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:dui="http://openorganize.com/platform/dui">

	<h2>
		<h:outputText value="#{createImprintWizard.wizardTitle}" />
	</h2>

	<div id="step1">
		<ul class="steps">
			<li class="selected">1. Info</li>
			<li class="disabled">2. Results</li>
		</ul>
		<div class="cluster smart">

		<a:outputPanel layout="none" id="noLayoutErrorMsgs">
				<s:div styleClass="alert">
					<s:div rendered="#{not empty createImprintWizard.errorMsgs}" id="errorMsgsDiv">
						<a:repeat value="#{createImprintWizard.errorMsgs}" var="_errMsg">
							<p>#{_errMsg}</p>
						</a:repeat>
					</s:div>
				</s:div>
		</a:outputPanel>
		<a:outputPanel layout="none" id="choosePublishersPanel">
		<s:div id="choosePublishersFragment"  styleClass="field">		
			
			<label>Choose Publishers</label>
					
			<h:inputText id="default_search_catPublishersList" 
			 			value="#{catPublishersList.catPublishers.catName}"
			 			onchange="return false;" size="60">		
			 	<a:support event="onblur"  	ajaxSingle="true" eventsQueue="#{divParam}eventsQueue"/>	 			
			</h:inputText>
	
			<a:commandLink 
			  		 styleClass="button filter"
					 value="Filter"
					 action="#{createImprintWizard.narrowList(rich:findComponent('default_search_catPublishersList').value)}"
					 reRender="createImprintWizard"
					 status="globalWaitStatus"
					 ajaxSingle="true" 
					 eventsQueue="#{divParam}eventsQueue"
					 ignoreDupResponses="true"
					 limitToList="true"/>		
			 
			<rich:dataTable id="publishers"
				value="#{createImprintWizard.publishersList}" var="_publisher">
				<rich:column styleClass="checkBoxes" headerClass="checkBoxes">
					<h:selectBooleanCheckbox styleClass="publisher_checkbox"
						value="#{createImprintWizard.selectionsForPublishers[_publisher]}"
						onclick="emulateRadios(this, 'publisher_checkbox');" >
						<a:support event="onchange" 
							action="#{createImprintWizard.selectPublisher()}"
							reRender="choosePublishersPanel,noLayoutErrorMsgs"
							eventsQueue="#{divParam}eventsQueue"
							status="globalWaitStatus"
							ajaxSingle="true"
							limitToList="true"/>
					</h:selectBooleanCheckbox>
				</rich:column>

				<cats:wizardColumn entityList="#{catPublishersList}"
					propertyLabel="ID" propertyName="id"
					propertyPath="catPublishers.id"
					propertyValue="#{catPublishersList.catPublishers.id}"
					reRender="publishers" value="#{_publisher.id}" />
				<cats:wizardColumn entityList="#{catPublishersList}"
					propertyLabel="Name" propertyName="catName"
					propertyPath="catPublishers.catName"
					propertyValue="#{catPublishersList.catPublishers.catName}"
					reRender="publishers" value="#{_publisher.catName}" />
				<cats:wizardColumn entityList="#{catPublishersList}"
					propertyLabel="Organization Type"
					propertyName="catOrganizationType"
					propertyPath="catPublishers.catOrganizationType"
					propertyValue="#{catPublishersList.catOrganizationType.label}"
					reRender="publishers" value="#{_publisher.catOrganizationType.label}" />
				<cats:wizardColumn entityList="#{catPublishersList}"
					propertyLabel="Country" propertyName="catCountry"
					propertyPath="catPublishers.catCountry"
					propertyValue="#{catPublishersList.catPublishers.catCountry.label}"
					reRender="publishers" value="#{_publisher.catCountry.label}" />
			</rich:dataTable>
		</s:div>	
		
			<s:div styleClass="blanktable" rendered="#{empty createImprintWizard.publishersList}">
				<span>Choose a Publisher.</span>
			</s:div>		
		</a:outputPanel>	
		<div class="push"></div>	
		
		<s:decorate id="catImprintName" template="../layout/edit.xhtml">
				<ui:define name="label">Name</ui:define>
				<h:inputText id="imprintName" size="25" maxlength="255"
                           requiredMessage="Required" required="true" 
					value="#{createImprintWizard.catImprints.mainName}"></h:inputText>
				<span class="comments">Imprint name.</span>
		</s:decorate>
		
		<s:decorate id="catLtmPrefix" template="../layout/edit.xhtml">
				<ui:define name="label">LTM Prefix</ui:define>
				<h:inputText id="ltmPrefix" size="25" maxlength="25"
					value="#{createImprintWizard.catImprints.catLtmIdPrefix}"></h:inputText>
				<span class="comments">Literatum ID Prefix</span>
		</s:decorate>
		
		<s:decorate id="catLtmCode" template="../layout/edit.xhtml">
				<ui:define name="label">LTM Code</ui:define>
				<h:inputText id="ltmCode" size="25" maxlength="25"
					value="#{createImprintWizard.catImprints.catLtmCode}"></h:inputText>
				<span class="comments">Literatum Code</span>
		</s:decorate>
		
		<s:decorate id="catDisplayOnPlatformId" template="../layout/edit.xhtml">
			<ui:define name="label">Display on Platform</ui:define>
			<h:selectOneMenu onchange="enableSaveCancel();" 
				required="true" name="catDisplayOnPlatform" value="#{createImprintWizard.catImprints.catDisplayOnPlatform}">
				   		<s:selectItems itemValue="#{i.value}" label="#{i.label}" noSelectionLabel="Choose..." value="#{listsForEnums.yesNo}" var="i"/>
			</h:selectOneMenu>
		</s:decorate>
				
		</div>

		<div class="push"></div>

		<a:commandLink styleClass="button" value="Quit"
			status="globalWaitStatus" ignoreDupResponses="true"
			eventsQueue="#{divParam}eventsQueue"
			reRender="createImprintWizard" 	limitToList="true"
			oncomplete="#{rich:component('createImprintQuit')}.show(); return false;">
		</a:commandLink>

		<a:commandLink styleClass="button right" value="Save"
			status="globalWaitStatus" ignoreDupResponses="true"
			eventsQueue="#{divParam}eventsQueue"
			action="#{createImprintWizard.performCreateOperation()}"
			reRender="createImprintWizard" limitToList="true"/>
	</div>

</ui:composition>

