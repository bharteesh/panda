<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:z="http://www.qualcomm.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:cats="http://www.ithaka.org/cats"
	xmlns:s="http://jboss.com/products/seam/taglib">

	<h2><h:outputText value="#{contractsLifecycleWizard.wizardTitle}"/></h2>

	<div id="step1">
	<ul class="steps">
		<li class="disabled">1. Change</li>
		<li class="disabled">2. Details</li>
		<li class="selected">3. Roles-Riders</li>
		<li class="disabled">4. Results</li>
	</ul>
	<div class="cluster">
		<s:div styleClass="title change" rendered="#{not empty contractsLifecycleWizard.pubsToCmptsRolesBeanList}">
					<h1> Publisher Roles </h1>
		</s:div>
		<div class="smart roles">
		<rich:dataTable id="catPubRolesTbl" styleClass="scroller"
						var="_pubscmpts" value="#{contractsLifecycleWizard.pubsToCmptsRolesBeanList}">						
			    <rich:column>
				    <f:facet name="header">
				       	<h:outputText value="Component"/>
				    </f:facet>
			       	<h:outputText value="#{_pubscmpts.cmpts.catName}"/>
			    </rich:column>
			    <rich:column>
			       	<ui:repeat value="#{_pubscmpts.pubsList}" var="_pubs">											
				       	<ui:repeat value="#{contractsLifecycleWizard.getPubsToCmptsList(_pubs, _pubscmpts.cmpts)}" var="_pubToCmpts">
	                         <rich:column styleClass="checkBoxes" headerClass="checkBoxes">		                	
		                          <div class="headline">
		                				<h:outputText value="#{_pubs.catName}"/>
			              		  </div>
									<h:selectManyCheckbox layout="pageDirection" name="catLicensorRoles" value="#{contractsLifecycleWizard.selectionsForRoles[_pubToCmpts]}" 
																rendered="#{contractsLifecycleWizard.origInstance.catType eq 'Backfile'}" styleClass="checklist">
										<f:selectItem itemLabel="Backfile Licensor" itemValue="Licensor" itemDisabled="true"/>
										<s:selectItems  itemValue="#{i}" label="#{i.label}" value="#{contractsLifecycleWizard.catPublishersToCmpts_Role}" var="i"/>
									</h:selectManyCheckbox>	
									<h:selectManyCheckbox layout="pageDirection" name="catLicensorRoles" value="#{contractsLifecycleWizard.selectionsForRoles[_pubToCmpts]}" 
														rendered="#{contractsLifecycleWizard.origInstance.catType eq 'Csp'}" styleClass="checklist">
										<f:selectItem itemLabel="CSP Licensor" itemValue="Csplicensor" itemDisabled="true"/>
										<s:selectItems  itemValue="#{i}" label="#{i.label}" value="#{contractsLifecycleWizard.catPublishersToCmpts_Role}" var="i"/>
									</h:selectManyCheckbox>
								</rich:column>	
							</ui:repeat>
	                  	</ui:repeat>
	             </rich:column>		
		</rich:dataTable>
		</div>
		
		<s:fragment rendered="#{(contractsLifecycleWizard.newLifecycleValue eq 'Active' or contractsLifecycleWizard.newLifecycleValue eq 'Terminated') 
														and	contractsLifecycleWizard.origInstance.catType eq 'Backfile'}">
			<s:div styleClass="title change" >
					<h1> Riders </h1>
			</s:div>
			<rich:listShuttle id="ridersPickList" 
					  sourceValue="#{contractsLifecycleWizard.availableRiders}"
					  targetValue="#{contractsLifecycleWizard.currentRiders}"			  		 
					  sourceCaptionLabel="Available Riders" 	 	   
					  targetCaptionLabel="Current Riders"			  			  
					  var="_rider"
					  converter="#{org.jboss.seam.ui.EntityConverter}"
					  copyControlLabel="Add"
					  copyAllControlLabel="Add all"
					  sourceListWidth="315" targetListWidth="315" listsHeight="350">
			     	<rich:column>
		                <h:outputText value="#{_rider.catName}"></h:outputText>
		            </rich:column>
			</rich:listShuttle>
		</s:fragment>
	</div>
	
     <div class="push"></div>                     
	<a:commandLink styleClass="button" value="Quit" limitToList="true"
		oncomplete="#{rich:component('contractsLifecycleUpdateQuit')}.show();"  status="globalWaitStatus" ignoreDupResponses="true"/>
	        
	
	<a:commandLink styleClass="button right" value="Continue" status="globalWaitStatus" ignoreDupResponses="true"			
			action="#{contractsLifecycleWizard.advLfclNext}" reRender="contractsLfclWizard" limitToList="true"/>
	
	
	</div>
</ui:composition>
