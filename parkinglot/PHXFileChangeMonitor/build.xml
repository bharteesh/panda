<?xml version="1.0"?>
<project name="PHXFileChangeMonitor" default="deploy" basedir=".">
	<property file="build.properties" />
	<property name="project.war" value="${warFile}" />
	<property name="fromLocation" value="${fromLocation}" />
	<property name="toLocation" value="${toLocation}" />
	<property name="user" value="${user}" />
	<property name="password" value="${password}" />
	<property name="host" value="{$host}" />

	<echo message="${warFile}" />
	<echo message="${fromLocation}" />
	<echo message="${toLocation}" />
	<echo message="${user}" />
	<echo message="${password}" />
	<echo message="${host}" />


	<target name="test">
		<condition property="is.resource.exists" value="true" else="false">
			<echo message="step1" />
			<and>
				<resourceexists>
					<echo message="step2"/>
					<file file="${warFile}.war" />
					<echo message="step3" />
				</resourceexists>
			</and>
		</condition>
	</target>

	<target name="clean" if="is.resource.exists" depends="test">
		<echo message="step4" />
		<sshexec host="${host}"
	       	  username="${user}"
	       	  password="${password}"
	       	  command=" rm ${toLocation}/${warFile}.war"  verbose="true"/>
	</target>



	<target name="deploy" depends="clean">
		<scp file="${fromLocation}/${warFile}.war" 
   		todir="${user}:${password}@${host}:${toLocation}" trust="true"  verbose="true"/>
	</target>
</project>