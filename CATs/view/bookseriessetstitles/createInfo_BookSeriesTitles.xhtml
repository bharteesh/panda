<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:z="http://www.qualcomm.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:cats="http://www.ithaka.org/cats"
	xmlns:s="http://jboss.com/products/seam/taglib">

	<h2><h:outputText value="#{createBookSeriesTitleWizard.createTitle}" /></h2>

	<div id="step1">
		<ul class="steps">
			<li class="selected">1. Info</li>
			<li class="disabled">2. Results</li>
		</ul>
	
		<div class="cluster smart">
			<a:outputPanel layout="none" id="noLayoutErrorMsgs">
				<s:div styleClass="alert">
					<s:div rendered="#{not empty createBookSeriesTitleWizard.errorMsgs}" id="errorMsgsDiv">
						<a:repeat value="#{createBookSeriesTitleWizard.errorMsgs}" var="_errMsg">
							<p>#{_errMsg}</p>
						</a:repeat>
					</s:div>
				</s:div>
			</a:outputPanel>
			<s:div id="bookSeriesSearchField" 
				rendered="#{createBookSeriesTitleWizard.wizardInvokedFrom eq createBookSeriesTitleWizard.INVOKED_FROM_BOOKSERIESTILES_LIST}"
				styleClass="field">
				<label>Choose Book Series </label>
				<h:inputText id="default_search_catBookSeries" 
		 			value="#{createBookSeriesTitleWizard.bookSeriesSearchFieldName}" 
		 			onchange="return false;" size="60">
		 			<a:support event="onblur"
                    	eventsQueue="createBookSeriesTitleQueue"
                    	ajaxSingle="true"
                    	limitToList="true"/>
		 		</h:inputText>
		 		<a:commandLink 
			  		 styleClass="button filter"
					 value="Filter by Main Title"
					 action="#{createBookSeriesTitleWizard.narrowBookSeriesList(rich:findComponent('default_search_catBookSeries').value)}"
					 reRender="noLayoutBookSeriesList"
					 status="globalWaitStatus" 
					 ajaxSingle="true"
					 eventsQueue="createBookSeriesTitleQueue"
					 limitToList="true"/>
			</s:div>
			<s:div id="bookSeriesSearchField1" 
				rendered="#{createBookSeriesTitleWizard.wizardInvokedFrom eq createBookSeriesTitleWizard.INVOKED_FROM_BOOKSERIES_RECORD}"
				styleClass="field">
				<label>Book Series </label>
				<span></span>
			</s:div>
			
			<a:outputPanel layout="none" id="noLayoutBookSeriesList">
				
					<ui:include src="/bookseriessetstitles/createBookSeriesTitleTable_BookSeries.xhtml"/>
				
			</a:outputPanel>
		
		
			<br/>
			
			
			<div class="title change">
				<h1>Info</h1>
				<p>Fill out basic information about the Book Series Title</p>
			</div>
			
			<s:decorate template="../layout/edit.xhtml">
				<ui:define name="label">Initial Article</ui:define>
				<h:inputText
					id="catInitialArticle" maxlength="20" size="25"
					value="#{createBookSeriesTitleWizard.bookSeriesInitArticle}" />
				<span class="comments">Examples: the, a, la,el </span>
			</s:decorate>
			<s:decorate template="../layout/edit.xhtml">
				<ui:define name="label">Title</ui:define>
				 <h:inputTextarea cols="20" required="true" id="bookSeriesTitle"
                     rows="2" value="#{createBookSeriesTitleWizard.bookSeriesTitle}">
                     <a:support event="onblur"
                    	eventsQueue="createBookSeriesTitleQueue"
                    	ajaxSingle="true"
                    	limitToList="true"/>
                 </h:inputTextarea>
                <span class="comments">
                	<a:commandLink styleClass="button find" value="Check for Series with Same Name"
						action="#{createBookSeriesTitleWizard.checkForDuplicates}"
						reRender="noLayoutNoDups, noLayoutHasDups, noLayoutNoJrnls, noLayoutHasJrnls" 
						eventsQueue="createBookSeriesTitleQueue"
						status="globalWaitStatus"
						ajaxSingle="true"
						limitToList="true"/>
					<br/><br/>
                	<a:commandLink styleClass="button find" value="Check for Journals with Same Name"
						action="#{createBookSeriesTitleWizard.checkForJournals}"
						reRender="noLayoutNoDups, noLayoutHasDups, noLayoutNoJrnls, noLayoutHasJrnls" 
						eventsQueue="createBookSeriesTitleQueue"
						status="globalWaitStatus"
						ajaxSingle="true"
						limitToList="true"/>
                	
                </span>
			</s:decorate>
			
			<a:outputPanel layout="none" id="noLayoutNoDups">
				<s:div rendered="#{createBookSeriesTitleWizard.checkForDup and !createBookSeriesTitleWizard.hasDups}" styleClass="alert eligible">
					<p>No other book series share this title.</p>
				</s:div>
			</a:outputPanel>
			
			<a:outputPanel layout="none" id="noLayoutHasDups">
				<s:div rendered="#{createBookSeriesTitleWizard.checkForDup and createBookSeriesTitleWizard.hasDups}" styleClass="alert">
					<p><strong>#{createBookSeriesTitleWizard.seriesWithDuplicateTitles.size}</strong> book series share this title. Click <strong>Continue</strong> if you want to make the duplicate.</p>
				</s:div>
				<s:div rendered="#{createBookSeriesTitleWizard.checkForDup and createBookSeriesTitleWizard.hasDups}" styleClass="scroller">
				
					<rich:dataTable id="bookSeriesTableWiz"
		                var="_catBookSeries"
		              	value="#{createBookSeriesTitleWizard.seriesWithDuplicateTitles}"
		              	rowClasses="odd,even">
		           
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="Main Title"/>
				        	</f:facet>
							<h:outputText value="#{_catBookSeries.mainTitle}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="Book Series Publishers"/>
				        	</f:facet>
							<h:outputText value="#{_catBookSeries.seriesPublishers}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="EISSN"/>
				        	</f:facet>
							<h:outputText value="#{_catBookSeries.catEIssn}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="ID"/>
				        	</f:facet>
							<h:outputText value="#{_catBookSeries.id}" />        		
			        	</rich:column>
			        	
		        	</rich:dataTable>
		   			
		        </s:div>
			   
			</a:outputPanel>
			<a:outputPanel layout="none" id="noLayoutNoJrnls">
				<s:div rendered="#{createBookSeriesTitleWizard.checkForJrnl and !createBookSeriesTitleWizard.hasJrnlsMatchingSeriesTitle}" styleClass="alert eligible">
					<p>No Journals found with name <b>#{createBookSeriesTitleWizard.bookSeriesTitle}</b>.</p>
				</s:div>
			</a:outputPanel>
			
			<a:outputPanel layout="none" id="noLayoutHasJrnls">
				<s:div rendered="#{createBookSeriesTitleWizard.checkForJrnl and createBookSeriesTitleWizard.hasJrnlsMatchingSeriesTitle}" styleClass="alert">
					<p><strong>#{createBookSeriesTitleWizard.jrnlsMatchingSeriesTitle.size}</strong> journals found with name <strong>#{createBookSeriesTitleWizard.bookSeriesTitle}</strong>.</p>
				</s:div>
				<s:div rendered="#{createBookSeriesTitleWizard.checkForJrnl and createBookSeriesTitleWizard.hasJrnlsMatchingSeriesTitle}" styleClass="smart scroller">
				
				
		   			<rich:dataTable id="bookSeriesTitleCmptTableWiz"
		                var="_catCmpts"
		              	value="#{createBookSeriesTitleWizard.jrnlsMatchingSeriesTitle}"
		              	rowClasses="odd,even">
		              	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="Set Name"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.setsValue}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="Component Name"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.catName}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="Backfile Summary"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.bfOverallOnboardingStatus}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="CSP Onboarding"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.catCspOnboardingStatus.label}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="ISSN"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.catPrintIssn}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="Extent (Dates)"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.catDateRange}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="Participation"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.catParticipationDate}" >
								<s:convertDateTime type="date" pattern="yyyy/MM/dd"/>
							</h:outputText>        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="On Hold"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.catOnHold ? 'Yes' : 'No'}" />        		
			        	</rich:column>
			        	
			        	<rich:column>
				        	<f:facet name="header">
				        		<h:outputText value="ID"/>
				        	</f:facet>
							<h:outputText value="#{_catCmpts.id}" />        		
			        	</rich:column>
			        	
		            </rich:dataTable>
		        </s:div>
			</a:outputPanel>
			<br/>
			<s:decorate template="../layout/edit.xhtml">
				<ui:define name="label">Title Type</ui:define>
					<h:selectOneMenu name="bookSeriesTitleType" required="true"  
						value="#{createBookSeriesTitleWizard.bookSeriesTitleType}"
						requiredMessage="You must indicate the Title Type.">
						<s:selectItems itemValue="#{i}" label="#{i.label}" noSelectionLabel="Choose..." 
							value="#{createBookSeriesTitleWizard.catBookSeriesSetsTitles_Type}" var="i"/>
					</h:selectOneMenu>
				<span class="comments">Book Series Title Type.</span>
			</s:decorate>
			
		</div>
		<div class="push"></div>
		<a:commandLink styleClass="button" value="Quit"
      		eventsQueue="createBookSeriesTitleQueue"
            status="globalWaitStatus"
		    oncomplete="#{rich:component('createBookSeriesTitleQuit')}.show(); return false;"
		    ajaxSingle="true"
		    limitToList="true"/>
			 
 
		<a:commandLink
			styleClass="button right" value="Save"
			eventsQueue="createBookSeriesTitleQueue"
            status="globalWaitStatus"
			action="#{createBookSeriesTitleWizard.performCreateOperation}" 
			reRender="createBookSeriesTitleForm" 
			limitToList="true"/>
		
	</div>
</ui:composition>