<ui:composition
xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:z="http://www.qualcomm.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:cats="http://www.ithaka.org/cats"
	xmlns:s="http://jboss.com/products/seam/taglib"
      xmlns:dui="http://openorganize.com/platform/dui"
>

	<h2><h:outputText value="#{createIssueShipmentsWizard.createTitle}" /></h2>
	
		<div id="step1">
		<!--  Note: Kludge, if this issueshipment were part of a sub-wizard whose parent is 'advance lifecycle order' we cannot complete the shipment so 
		            under these sub-wizard conditions we should hide the 'Additional' step for completion. -->
		<s:div rendered="#{createIssueShipmentsWizard.checkIfCreateIssueShipmentLifecycleCompletable() == true}">
		<ul class="steps">
				<li class="selected">1. Choose</li>
				<li class="disabled">2. Main</li>
				<li class="disabled">3. Parent</li>
				<li class="disabled">4. Additional</li>
				<li class="disabled">5. Results</li>
		</ul>
		</s:div>
		<s:div rendered="#{createIssueShipmentsWizard.checkIfCreateIssueShipmentLifecycleCompletable() == false}">
		<ul class="steps">
				<li class="selected">1. Choose</li>
				<li class="disabled">2. Main</li>
				<li class="disabled">3. Parent</li>
				<li class="disabled">4. Results</li>
		</ul>
		</s:div>
		
		<div class="cluster smart">
		<p>Choose one of the followings Acquisition Orders</p>
<!--  Note: If this were a sub-wizard, this screen itself will be hidden, as per new requirements, so this piece of fragment will currently not be exercised -->
<s:fragment rendered="#{createIssueShipmentsWizard.isSubWizard == true}">
<div class="scroller">
	<rich:dataTable id="acqOrdersCurrent" value="#{createIssueShipmentsWizard.catAcqOrdersWithOrderedLifecycleList}" var="_catAcqOrders">
		<rich:column styleClass="checkBoxes" headerClass="checkBoxes">
				<h:selectBooleanCheckbox styleClass="catAcqOrders_checkbox"
						value="#{createIssueShipmentsWizard.selectionsForEntities[_catAcqOrders]}" 
						onclick="emulateRadios(this, 'catAcqOrders_checkbox');"/>
		</rich:column>
		<rich:column id="catAcqOrdersId" sortBy="#{_catAcqOrders.id}" sortable="true" filterBy="#{_catAcqOrders.id}">
			<f:facet name="header">ID</f:facet>
			<h:outputText value="#{_catAcqOrders.id}"/>
		</rich:column>
		<rich:column id="catAcqOrdersCatLifecycle" sortBy="#{_catAcqOrders.catLifecycle}" sortable="true" filterBy="#{_catAcqOrders.catLifecycle}">
			<f:facet name="header">Lifecycle</f:facet>
			<h:outputText value="#{_catAcqOrders.catLifecycle}"/>
		</rich:column>
		<rich:column id="catAcqOrdersCatType" sortBy="#{_catAcqOrders.catType}" sortable="true" filterBy="#{_catAcqOrders.catType}">
			<f:facet name="header">Type</f:facet>
			<h:outputText value="#{_catAcqOrders.catType}"/>
		</rich:column>
<!-- If there are too many Acq Order rows, these 2 statements start pulling the sets for each acq order and the time taken is huge and transaction times out and UI Crashes !!, but
        here we have just 1 row, it okay --> 		
		<rich:column id="catAcqOrdersCatSetsName" sortBy="#{_catAcqOrders.catSets.catCurrentTitle.catName}" sortable="true" filterBy="#{_catAcqOrders.catSets.catCurrentTitle.catName}">
			<f:facet name="header">Set Name</f:facet>
			<h:outputText value="#{_catAcqOrders.catSets.catCurrentTitle.catName}"/>
		</rich:column>
		<rich:column id="catAcqOrdersCatCmptsName" sortBy="#{_catAcqOrders.catCmpts.catName}" sortable="true" filterBy="#{_catAcqOrders.catCmpts.catName}">
			<f:facet name="header">Component Name</f:facet>
			<h:outputText value="#{_catAcqOrders.catCmpts.catName}"/>
		</rich:column>
		<rich:column id="catAcqOrdersCatSupplier" sortBy="#{_catAcqOrders.catSupplier}" sortable="true" filterBy="#{_catAcqOrders.catSupplier}">
			<f:facet name="header">Supplier</f:facet>
			<h:outputText value="#{_catAcqOrders.catSupplier}"/>
		</rich:column>
		<rich:column id="catAcqOrdersCatPublctnUnitRange" sortBy="#{_catAcqOrders.catPublctnUnitRange}" sortable="true" filterBy="#{_catAcqOrders.catPublctnUnitRange}">
			<f:facet name="header">Extent (Pub Units)</f:facet>
			<h:outputText value="#{_catAcqOrders.catPublctnUnitRange}"/>
		</rich:column>
		<rich:column id="catAcqOrdersCatCoverDateRange" sortBy="#{_catAcqOrders.catCoverDateRange}" sortable="true" filterBy="#{_catAcqOrders.catCoverDateRange}">
			<f:facet name="header">Extent (Dates)</f:facet>
			<h:outputText value="#{_catAcqOrders.catCoverDateRange}"/>
		</rich:column>
		<rich:column id="catAcqOrdersCatOnHold" sortBy="#{_catAcqOrders.catOnHold}" sortable="true" filterBy="#{_catAcqOrders.catOnHold}">
			<f:facet name="header">On Hold</f:facet>
			<h:outputText value="#{_catAcqOrders.catOnHold}"/>
		</rich:column>
	</rich:dataTable>
</div>
</s:fragment>

<s:fragment rendered="#{createIssueShipmentsWizard.isSubWizard == false}">
<s:div id="chooseAcqOrdersFragment">
			<h:inputText id="default_search_orderedAcqOrdersList_sets" value="#{orderedAcqOrdersList.catAcqOrders.catSets.catCurrentTitle.catName}" size="60" onchange="return false;"/>

		  <a:commandLink 
		  		 styleClass="button filter"
				 value="Filter list on Set Name"
				 action="#{createIssueShipmentsWizard.narrowListBySets(rich:findComponent('default_search_orderedAcqOrdersList_sets').value)}"
				 reRender="chooseAcqOrdersFragment"
				 status="globalWaitStatus"
				 />

<br/>
		  <h:inputText id="default_search_orderedAcqOrdersList_cmpts" value="#{orderedAcqOrdersList.catAcqOrders.catCmpts.catName}" size="60" onchange="return false;"/>
		  <a:commandLink 
		  		 styleClass="button filter"
				 value="Filter list on Component Name"
				 action="#{createIssueShipmentsWizard.narrowListByCmpts(rich:findComponent('default_search_orderedAcqOrdersList_cmpts').value)}"
				 reRender="chooseAcqOrdersFragment"
				 status="globalWaitStatus"
				 />
<br/>

			<div class="scroller">
				<rich:panel>
					<f:facet name="header">
						<h:outputText value="Orders (#{orderedAcqOrdersList.resultCount})" />
					</f:facet>
				</rich:panel>


			  <rich:dataTable id="acqOrders"
				value="#{orderedAcqOrdersList.resultList}" var="_acqOrders">
				<rich:column styleClass="checkBoxes" headerClass="checkBoxes">
					<h:selectBooleanCheckbox styleClass="catAcqOrders_checkbox"
						value="#{createIssueShipmentsWizard.selectionsForEntities[_acqOrders]}"
						onclick="emulateRadios(this, 'catAcqOrders_checkbox');" />
				</rich:column>

		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="ID"
			propertyName="id"
			propertyPath="catAcqOrders.id"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.id}"
			reRender="acqOrders"
			value="#{_acqOrders.id}"
		/>
		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="Lifecycle"
			propertyName="catLifecycle"
			propertyPath="catAcqOrders.catLifecycle"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.catLifecycle}"
			reRender="acqOrders"
			value="#{_acqOrders.catLifecycle}"
		/>
		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="Type"
			propertyName="catType"
			propertyPath="catAcqOrders.catType"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.catType}"
			reRender="acqOrders"
			value="#{_acqOrders.catType}"
		/>


		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="Set Name"
			propertyName="setName"
			propertyPath="catAcqOrders.catSets.catCurrentTitle.catName"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.catSets.catCurrentTitle.catName}"
			reRender="acqOrders"
			value="#{_acqOrders.catSets.catCurrentTitle.catName}"
		/>

		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="Component Name"
			propertyName="cmptName"
			propertyPath="catAcqOrders.catCmpts.catName"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.catCmpts.catName}"
			reRender="acqOrders"
			value="#{_acqOrders.catCmpts.catName}"
		/>

		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="Supplier"
			propertyName="catSupplier"
			propertyPath="catAcqOrders.catSupplier"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.catSupplier}"
			reRender="acqOrders"
			value="#{_acqOrders.catSupplier}"
		/>
		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="Cover Date Range"
			propertyName="catCoverDateRange"
			propertyPath="catAcqOrders.catCoverDateRange"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.catCoverDateRange}"
			reRender="acqOrders"
			value="#{_acqOrders.catCoverDateRange}"
		/>
		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="Publication Unit Range"
			propertyName="catPublctnUnitRange"
			propertyPath="catAcqOrders.catPublctnUnitRange"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.catPublctnUnitRange}"
			reRender="acqOrders"
			value="#{_acqOrders.catPublctnUnitRange}"
		/>
		<cats:wizardColumn
			entityList="#{orderedAcqOrdersList}"
			propertyLabel="On Hold"
			propertyName="catOnHold"
			propertyPath="catAcqOrders.catOnHold"
			propertyValue="#{orderedAcqOrdersList.catAcqOrders.catOnHold}"
			reRender="acqOrders"
			value="#{_acqOrders.catOnHold}"
		/>




			</rich:dataTable>
			</div>
	</s:div>




</s:fragment>



			</div>

		<div class="push"></div>
            <a:commandLink styleClass="button" value="Quit"
       			eventsQueue="#{divParam}eventsQueue"
               	status="globalWaitStatus"
			    reRender="createIssueShipmentswizard" oncomplete="#{rich:component('createIssueShipmentsQuit')}.show(); return false;">
			</a:commandLink> 

			<a:commandLink
			rendered="#{createIssueShipmentsWizard.isSubWizard == false}"
			styleClass="button right" value="Continue"
			eventsQueue="#{divParam}eventsQueue"
            status="globalWaitStatus"
			onclick="if(checkRadios('catAcqOrders_checkbox', 'Please select an acquisition Order') == false) {return false}"
			action="#{createIssueShipmentsWizard.createNext}" 
			reRender="createIssueShipmentswizard" />

			<a:commandLink
			rendered="#{createIssueShipmentsWizard.isSubWizard == true}"
			styleClass="button right" value="Continue"
			eventsQueue="#{divParam}eventsQueue"
            status="globalWaitStatus"
			action="#{createIssueShipmentsWizard.createNext}" 
			reRender="createIssueShipmentswizard" />

			</div>
	
</ui:composition>

